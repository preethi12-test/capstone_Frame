"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const devkit_1 = require("@nx/devkit");
const tree_1 = require("nx/src/generators/tree");
const normalize_options_1 = require("./lib/normalize-options");
const run_wdio_1 = require("./lib/run-wdio");
const start_dev_server_1 = require("./lib/start-dev-server");
async function runExecutor(options, context) {
    const tree = new tree_1.FsTree(devkit_1.workspaceRoot, false);
    const wdioOptions = (0, normalize_options_1.normalizeOptions)(tree, options, context);
    try {
        wdioOptions.baseUrl = await (0, start_dev_server_1.startDevServer)(wdioOptions, context);
        await (0, run_wdio_1.generateWdioConfig)(tree, wdioOptions);
        await (0, run_wdio_1.runWdio)(wdioOptions);
        await (0, run_wdio_1.unlinkWdioConfig)(wdioOptions);
        return { success: true };
    }
    catch (error) {
        await (0, run_wdio_1.unlinkWdioConfig)(wdioOptions);
        if (context.isVerbose)
            console.error(error);
        return { success: false };
    }
}
exports.default = runExecutor;
//# sourceMappingURL=executor.js.map